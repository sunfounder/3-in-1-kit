回路の作成方法
========================

私たちが日常で使用している多くのものは、家の照明やこのコンピュータのように、電気で動いています。

電気を利用するためには、電気回路を組む必要があります。基本的に、回路は電気が流れる経路、または電子回路であり、特定の方法で接続された電気デバイスやコンポーネント（家電製品）から成り立っています。例としては、抵抗器、コンデンサ、電源、スイッチなどがあります。

.. image:: img/circuit.png

回路とは、電子が移動して電流を生む閉じた経路のことを指します。電流を流すためには、電源の正極と負極の間に導電経路が必要です。これを閉回路といい、これが切断されると開回路と呼ばれます。

Arduinoボードには、いくつかの電源出力ピン（正）とグラウンドピン（負）があります。
これらのピンを電源の正極と負極として使用し、ボードに電源を接続することができます。

.. image:: img/arduinoPN.jpg

電気を使って、光や音、動きのある作品を作成することができます。
LEDの長いピンを正極に、短いピンを負極に接続することでLEDを点灯させることができます。
しかし、そのままではLEDがすぐに壊れてしまうため、回路内に220Ωの抵抗器を追加して保護する必要があります。

以下にその回路の形状を示します。

.. image:: img/sp221014_181625.png

「この回路をどうやって組むの？」と疑問に思うかもしれません。ワイヤーを手で持って接続するのか、ピンとワイヤーをテープで固定するのか。

このような場面で、はんだ付けの不要なブレッドボードが非常に役立ちます。

.. _bc_bb:

ブレッドボード、こんにちは！
------------------------------

ブレッドボードは、たくさんの小さな穴が開いている長方形のプラスチック板です。
これらの穴を利用して、電子部品を簡単に挿入し、電子回路を組むことができます。
ブレッドボードは電子部品を恒久的に固定しないので、何か問題が発生した場合でも、回路を簡単に修理してやり直すことができます。

.. note::
    ブレッドボードを使用するための特別なツールは必要ありません。しかし、多くの電子部品は非常に小さく、ピンセットを使用すると小さな部品をより簡単に取り扱うことができます。

インターネット上にはブレッドボードに関する多くの情報があります。

* `ブレッドボードの使用方法 - Science Buddies <https://www.sciencebuddies.org/science-fair-projects/references/how-to-use-a-breadboard#pth-smd>`_

* `BREADBOARDって何？ - Makezine <https://cdn.makezine.com/uploads/2012/10/breadboardworkshop.pdf>`_

ブレッドボードに関して知っておくべきいくつかの点を以下に示します。

#. 各半行グループ（例：行1の列A-Eや行3の列F-J）は接続されています。したがって、A1から電気信号が流れ込むと、B1、C1、D1、E1から流れ出ることができますが、F1やA2からは流れ出すことはできません。

#. ほとんどの場合、ブレッドボードの両側は電源バスとして使用され、各列の穴（約50の穴）は互いに接続されています。一般的に、正の電源は赤いワイヤーの近くの穴に、負の電源は青いワイヤーの近くの穴に接続されます。

#. 回路内で、電流は負極に到達するまでの間に負荷を通過して正極から流れます。この場合、短絡が発生する可能性があります。

**電流の流れる方向に沿って、回路を組み立てましょう！**

.. image:: img/connect_led.png

1. この回路では、ボードの5Vピンを使用してLEDに電力を供給します。M2Mジャンパーワイヤーを使用して、それを赤い電源バスに接続します。
#. LEDを保護するために、電流は220Ωの抵抗器を通過する必要があります。抵抗器の一方の端（どちらの端でもよい）を赤い電源バスに接続し、もう一方の端をブレッドボードのフリーローに接続します。

    .. note::
        220Ωの抵抗器のカラーリングは、赤、赤、黒、黒、茶色です。

#. LEDを手に取ると、リードの一方が他方よりも長いことがわかります。長いリードを抵抗器と同じ行に接続し、短いリードを他の行に接続します。

    .. note::
        長いリードはアノードと呼ばれ、回路の正面を表します。短いリードはカソードと呼ばれ、回路の負面を表します。 

        アノードは抵抗器を介してGPIOピンに接続する必要があり、カソードはGNDピンに接続する必要があります。

#. M2Mジャンパーワイヤーを使用して、LEDの短いピンをブレッドボードの負の電源バスに接続します。
#. ジャンパーを使用して、ボードのGNDピンを負の電源バスに接続します。

短絡に注意
------------------------------
短絡は、接続するべきでない二つの部品が「偶然」接続されたときに発生します。
このキットには、長い金属のピンを持つ抵抗器、トランジスタ、コンデンサ、LEDなどが含まれており、これらがお互いにぶつかって短絡を引き起こす可能性があります。短絡が発生すると、いくつかの回路は正常に機能しなくなります。時折、短絡は電源とグラウンドバスの間で部品を恒久的に損傷させ、回路が非常に熱くなり、ブレッドボードのプラスチックが溶け、部品が焼けてしまうことがあります！

したがって、ブレッドボード上のすべての電子部品のピンが互いに接触していないことを常に確認してください。


回路の向き
-------------------------------
回路には方向性があり、この方向性は特定の電子部品において非常に重要な役割を果たします。極性を持つデバイスがいくつかあり、これはその正と負の極に基づいて正しく接続する必要があることを意味します。方向を間違えて組み立てられた回路は正常に動作しません。

.. image:: img/connect_led_reverse.png

先ほど組み立てたこのシンプルな回路でLEDを逆にすると、もう動作しなくなることがわかります。

対照的に、この回路の抵抗器のように、方向性を持たないデバイスもあります。そのため、それらを逆にしてもLEDの正常な動作に影響はありません。

"+", "-", "GND", "VCC"などのラベルが付いている部品や異なる長さのピンを持つ部品は、特定の方法で回路に接続する必要があります。

回路の保護
-------------------------------------

電流は、完全な電気回路のある点を過ぎる電子の流れの速度です。基本的に、電流 = 流れです。アンペア（アンペア）は、電流を測定するための国際的な単位です。それは一定時間内に回路のある点を流れる電子の量（「電気的な充電」とも呼ばれる）を表します。

電流の流れの背後にある駆動力（電圧）は、電圧と呼ばれ、ボルト（V）で測定されます。

抵抗（R）は電流の流れを制限する材料の性質であり、オーム（Ω）で測定されます。

オームの法則によれば（温度が一定の場合）、電流、電圧、および抵抗は比例しています。
回路の電流はその電圧に比例し、その抵抗に反比例します。

したがって、電流（I）= 電圧（V）/ 抵抗（R）です。

* `オームの法則 - Wikipedia <https://en.wikipedia.org/wiki/Ohm%27s_law>`_

オームの法則に関して、簡単な実験を行うことができます。

.. image:: img/sp221014_183107.png

5Vを3.3Vに接続するワイヤーを変更すると、LEDの明るさが減少します。
抵抗を220オームから1000オーム（色リング：茶、黒、黒、茶、茶）に変更すると、LEDが以前よりも暗くなることに気付くでしょう。抵抗が大きいほど、LEDは暗くなります。

.. note::
    抵抗についての紹介や抵抗値の計算方法については、 :ref:`cpn_resistor` を参照してください。

ほとんどのパッケージ化されたモジュールは、適切な電圧（通常3.3Vまたは5V）にのみアクセスする必要があります、例えば超音波モジュールのようなもの。

しかし、自作の回路では、電子デバイスの供給電圧と抵抗の使用に注意する必要があります。

例として、LEDは通常20mAの電流を消費し、その電圧降下は約1.8Vです。オームの法則に従い、5Vの電源を使用する場合、LEDを焼き切らないためには、最低160オーム（(5-1.8)/20mA）の抵抗を接続する必要があります。

Arduinoでの回路制御
--------------------------------

Arduinoのプログラミングと電子回路の基本的な理解ができたので、最も重要な問いに立ち向かう時がきました：Arduinoで回路をどのように制御するか。

簡単に言えば、Arduinoが回路を制御する方法は、ボード上のピンのレベルを変更することです。例えば、オンボードLEDを制御するとき、ピン13に高いまたは低いレベルの信号を書き込みます。

さて、Arduinoボードをコード化して、ブレッドボード上の点滅するLEDを制御してみましょう。LEDがピン9に接続されているように回路を組み立てます。

.. image:: img/wiring_led.png
    :width: 400
    :align: center

次に、このスケッチをArduinoの開発ボードにアップロードします。

.. code-block:: C

    int ledPin = 9;
    int delayTime = 500;

    void setup() {
        pinMode(ledPin,OUTPUT); 
    }

    void loop() {
        digitalWrite(ledPin,HIGH); 
        delay(delayTime); 
        digitalWrite(ledPin,LOW); 
        delay(delayTime);
    }

このスケッチは、オンボードLEDの点滅を制御するために使用したものと非常に似ていますが、 ``ledPin`` の値が9に変更されている点が異なります。
これは、今回、ピン9のレベルを制御しようとしているからです。

これで、ブレッドボード上のLEDが点滅しているのが見えるでしょう。

